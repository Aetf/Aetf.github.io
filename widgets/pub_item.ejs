<style>
#timeline {
    margin: 0 auto;
    line-height: 1.5;
}

#timeline section.year {
    position: relative;

    padding: 1em 0em 1em 0em;
    margin-left: 3.5em;
    border-left: 2px solid rgba(.3, .3, .3, .3);

    /* Place the .year-mark-wrapper and ul at the same vertical point from the top edge */
    display: flex;
    align-items: flex-start;
}

#timeline section.year:last-child {
    border-image: linear-gradient(to bottom, rgba(.3, .3, .3, .3) 60%, rgba(.3, .3, .3, 0)) 1 100%;
}

/* The circle and year */
#timeline .year-mark-wrapper {
    /* Align .year-mark center within the height of a line */
    display: flex;
    align-items: center;
    width: 0px;
    /* sticky effect */
    position: sticky;
    top: 1em;
}
#timeline .year-mark-wrapper::before {
    /* Use the pseudo element to make the .year-mark-wrapper exactly the height of a line of text */
    content: "A";
    width: 0px;
    visibility: hidden;
}
#timeline .year-mark {
    position: relative;
    left: -8px;

    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-end;

    width: 10px;
    height: 10px;
    background: #C5C5C5;
    border: 2px solid #ffffff;
    border-radius: 10px;
    z-index: 2;
}

#timeline .year-mark::before {
    content: attr(data-year);
    font-size: 1rem;
    font-weight: bold;

    margin-right: 1em;
}
@media (min-width: 62em) {
    #timeline .year-mark::before {
        font-size: 1.1rem;
    }
}

/* The styling of the list */
#timeline section.year ul {
    padding: 0 0 0 2em;
    margin: 0em;
    font-size: 1em;
}
@media (min-width: 62em) {
    #timeline section.year section ul {
        font-size: 1.1em;
        padding-left: 2.2em;
    }
}

#timeline section.year ul li {
    list-style-type: none;
    padding: 1rem 0rem 1.25rem 0rem;
    border-bottom: 1px dashed #ccc;
}
#timeline section.year ul li:first-child {
    padding-top: 0rem;
}
#timeline section.year:last-child ul li:last-child {
    border-bottom: none;
}

/* The publication block */
#timeline .pub-block p {
    margin: 0;
    padding: 0;
}
</style>

<%_
    let year = '';
    let publications = page.site.data.publications.items;
    publications = publications.sort((a, b) => { return a.conference.date < b.conference.date; });
_%>
<div id="timeline">
<%_ publications.forEach(pub => { _%>
    <%_ pub.year = date(pub.conference.date, 'YYYY'); _%>
    <%_ if (year !== pub.year) { _%>
        <%_ if (year !== '') { _%>
        </ul>
    </section>
        <%_ } _%>
        <%_ year = pub.year; _%>
    <section class="year">
        <div class="year-mark-wrapper">
            <span class="year-mark" data-year="<%= year %>"></span>
        </div>
        <ul>
    <%_ } _%>
            <%# A single block for a paper #%>
            <li>
                <div class="pub-block">
                    <p class="pub-title"><%= pub.title %></p>
                    <p class="pub-authors">
                        <%_ pub.authors.forEach((author, idx) => { _%>
                        <%_ if (pub.authors.length > 2 && idx > 0) { -%>,<%_ } -%>
                        <%_ if (idx === pub.authors.length - 1 && pub.authors.length > 1) { -%> and <%_ } -%>

                        <span class="pub-author pub-author-<%= author.replace(' ', '-') %>"><%= author %></span> <%_ }); %>
                    </p>
                    <p>
                        <%= pub.conference.name %> (
                            <a title="<%= pub.conference.acceptance %>"
                                href="<%= pub.conference.url %>"><%= pub.conference.shortname %></a>
                        )
                    </p>
                    <div class="pub-links">
                        <% pub.links.forEach(link => { %>
                            <% let [link_name, link_url] = link.split(' || '); %>
                            <a href="<%= link_url %>">[<%= link_name %>]</a>
                        <% }); %>
                        <a class="pub-link-bibtex">[bibtex]</a>
                        <a class="pub-link-abstract">[abstract]</a>
                    </div>
                </div>
            </li>
<%_ }); _%>
<%# close last section #%>
<%_ if (year !== '') { _%>
        </ul>
    </section>
<%_ } _%>
</div>
